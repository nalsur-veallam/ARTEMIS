#ifndef DATA_H
#define DATA_H

#include <vector>
#include <cmath>

namespace data {
std::vector<double> dts = {0, 0.2, 0.4, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100};
std::vector<double> noise = {0.0, 1.1754286726808605e-05, 4.70171469072344e-05, 0.00016123413464720558, 0.000367511222973532, 0.0005858051404404891, 0.000812823074349917, 0.0010463530044580518, 0.0012846471437271488, 0.0015293424751950974, 0.0017755519314130266, 0.0020253240144285484, 0.0022771515863133653, 0.0025349457805313256, 0.002791170824080903, 0.0030555197043791297, 0.003317622066256975, 0.0035787070735514106, 0.003844782891247065, 0.004110560804746905, 0.004380259328080195, 0.0046482912882211845, 0.004918718269833134, 0.005192818747578016, 0.005471568607240629, 0.005742983256188009, 0.006016959324111223, 0.0062925178665515745, 0.006580531922388936, 0.006851309923506742, 0.007133353529813188, 0.007411140014567816, 0.00769316107775644, 0.007975229085361283, 0.008258433774749498, 0.00853975404097538, 0.008829376771339235, 0.009111953124435633, 0.009397164693674947, 0.009685830444280426, 0.009968836383295543, 0.010258594140661879, 0.010554023736009577, 0.010835369504056997, 0.01112711458423738, 0.011421008473790309, 0.011715098463029433, 0.012002345815635267, 0.012307046782549373, 0.012594044281148008, 0.012881790591192183, 0.01319134979552467, 0.01346333622515449, 0.013755774081302295, 0.014059605247402178, 0.014359528934510977, 0.0146527299379314, 0.014964427432463212, 0.015253778350905911, 0.01554553334007508, 0.01583550679978985, 0.016129673806502553, 0.016441515718956374, 0.01675546320549371, 0.01704187323687635, 0.017344275667446646, 0.017650525612991685, 0.017944822936168062, 0.018270142321748367, 0.01854735137098066, 0.018863622422713975, 0.019140390421966344, 0.019459908873943162, 0.019779577862569866, 0.02006980985936475, 0.020373687851061053, 0.020684093552581873, 0.020983992192958104, 0.021305057740417504, 0.021626042271927114, 0.021916450689137567, 0.02219099088921478, 0.022544276327826518, 0.022827687786831502, 0.023143190245213625, 0.023462573576263423, 0.023761336676800693, 0.02403144432377062, 0.02440806231474509, 0.024717785401240023, 0.025014636121429873, 0.025306876933826467, 0.025614009538351037, 0.025954730101151704, 0.026269823689269636, 0.026563691994370572, 0.026888476446275424, 0.02717141862444786, 0.027537368026414683, 0.027862216787555055, 0.028148430266317623, 0.028465800085062175, 0.028755054069843574};

std::vector<std::vector <double>> Coeffs = {{-8.273007774156475e-06, 0.00013408454894979052, 3.9674603874612336e-05, -8.427508898125448e-06, 8.89843437661904e-07, -3.526169046386325e-08}, {-8.273007774156475e-06, 0.00013408454894979052, 3.9674603874612336e-05, -8.427508898125448e-06, 8.89843437661904e-07, -3.526169046386325e-08}, {-8.273007774156475e-06, 0.00013408454894979052, 3.9674603874612336e-05, -8.427508898125448e-06, 8.89843437661904e-07, -3.526169046386325e-08}, {-1.5018796678544204e-05, 0.00017014601909840413, 1.1353094864734584e-05, -5.851526350988963e-07}, {-2.0563893754510314e-05, 0.00018673829469366117, 5.074260618629655e-06}, {-2.4319739956479196e-05, 0.0001933724571681233, 3.932035090737685e-06}, {-3.0090711727108e-05, 0.00020078993344496538, 2.952789408374341e-06}, {-3.373049407053496e-05, 0.0002043644467339455, 2.57713392525927e-06}, {-3.823561810322872e-05, 0.00020808105444049583, 2.238917396749665e-06}, {-1.3913743540651521e-05, 0.00016599748871177027, 1.3208263873192844e-05, -7.827109083684503e-07}, {-1.3913743540651521e-05, 0.00016599748871177027, 1.3208263873192844e-05, -7.827109083684503e-07}, {-8.273007774156475e-06, 0.00013408454894979052, 3.9674603874612336e-05, -8.427508898125448e-06, 8.89843437661904e-07, -3.526169046386325e-08}, {-8.273007774156475e-06, 0.00013408454894979052, 3.9674603874612336e-05, -8.427508898125448e-06, 8.89843437661904e-07, -3.526169046386325e-08}, {-9.272434517316932e-06, 0.00014099944037274535, 3.276616049650419e-05, -6.07951114531858e-06, 5.697552539772052e-07, -2.0191116456065193e-08}, {-1.0308675715084035e-05, 0.0001474990276323933, 2.6955630998719118e-05, -4.305383281826891e-06, 3.5198255493484507e-07, -1.0946468999906064e-08}, {-1.0847466871981206e-05, 0.00015059638111887026, 2.4446714795100198e-05, -3.6094140844297375e-06, 2.7423928090204057e-07, -7.940163590732278e-09}, {-1.1717701790474756e-05, 0.00015521852808921953, 2.1020566905915514e-05, -2.738067488816152e-06, 1.8489406018577653e-07, -4.766441842835121e-09}, {-1.2122000323753655e-05, 0.0001572147306755794, 1.9655647644900675e-05, -2.417428393674744e-06, 1.5449825536007252e-07, -3.767663407030651e-09}, {0.0001806569635646421, 5.247651824747856e-05, 4.051822946643342e-05, -4.322325419930226e-06, 2.336069979113893e-07, -4.932738184380131e-09}, {-1.321123274831363e-05, 0.00016202553028721013, 1.673631798642624e-05, -1.807223031788261e-06, 1.0292050514308383e-07, -2.253951364258362e-09}, {-1.3872486455753343e-05, 0.00016471611440832347, 1.524027507836413e-05, -1.5207317685952498e-06, 8.074446987807266e-08, -1.658344776547105e-09}, {-2.5017017234834444e-05, 0.0001768420174677836, 1.1560006753956682e-05, -1.0605380239690764e-06, 5.506484397060008e-08, -1.1183452318149493e-09}, {-2.5017017234834444e-05, 0.0001768420174677836, 1.1560006753956682e-05, -1.0605380239690764e-06, 5.506484397060008e-08, -1.1183452318149493e-09}, {0.005258612783132021, -0.0016071410912043027, 0.0002475814168195235, -1.6287117000119356e-05, 5.314275713428339e-07, -6.862937037025937e-09}, {-2.691303374781611e-05, 0.0001793695360787609, 1.0542995942667179e-05, -8.88383459950039e-07, 4.2128835436891524e-08, -7.621953952859604e-10}, {-2.691303374781611e-05, 0.0001793695360787609, 1.0542995942667179e-05, -8.88383459950039e-07, 4.2128835436891524e-08, -7.621953952859604e-10}, {0.025282110225544295, -0.006898992540377632, 0.0007948915174076336, -4.383845989703845e-05, 1.2011695275703443e-06, -1.306853832539357e-08}, {0.010150157296549958, -0.0026310150411409995, 0.0003170452398286398, -1.7291646755961762e-05, 4.6932074943272424e-07, -5.058253191411906e-09}, {0.0007589065007476592, -8.395924176123186e-05, 4.328251591228257e-05, -2.712900798532221e-06, 8.457223952806087e-08, -1.0315214965493104e-09}, {-2.6584760003978657e-05, 0.00017866579356559057, 1.0881481363043365e-05, -9.441357302190071e-07, 4.5165249243360875e-08, -7.78202034261186e-10}, {-2.6584760003978657e-05, 0.00017866579356559057, 1.0881481363043365e-05, -9.441357302190071e-07, 4.5165249243360875e-08, -7.78202034261186e-10}, {0.07114412861940911, -0.015339173700781762, 0.0013542524663898668, -5.8481176233207076e-05, 1.2570413413993777e-06, -1.0756188090817881e-08}, {0.025852183787430597, -0.005426748525933619, 0.0004905121917431858, -2.1023503225265584e-05, 4.485796357694593e-07, -3.8084703078916995e-09}, {0.0001470902881092681, 0.00012643975111411443, 1.4973540138578352e-05, -8.501616896242137e-07, 2.4616028938901885e-08, -2.7597455330575084e-10}, {0.0001470902881092681, 0.00012643975111411443, 1.4973540138578352e-05, -8.501616896242137e-07, 2.4616028938901885e-08, -2.7597455330575084e-10}, {0.19269076677022462, -0.03494701562634371, 0.002557974580601667, -9.254876109771578e-05, 1.6682428792933357e-06, -1.1984574759243277e-08}, {0.13806957580391674, -0.02479745855461077, 0.0018061209188407618, -6.479456990975844e-05, 1.1576966869272944e-06, -8.240467351018632e-09}, {-3.174206997323724e-05, 0.00018797325308282602, 7.0802330925103015e-06, -3.7170244063393405e-07, 1.074016818895561e-08, -1.2003053910622264e-10}, {0.00016151074565089012, 0.000126940496006283, 1.4245994085884032e-05, -7.629228786218296e-07, 2.0642574590587712e-08, -2.1211649940376946e-10}, {0.00016151074565089012, 0.000126940496006283, 1.4245994085884032e-05, -7.629228786218296e-07, 2.0642574590587712e-08, -2.1211649940376946e-10}, {0.03634731331565458, -0.006161095997711232, 0.00044579863539262395, -1.5344539619360962e-05, 2.624578993381706e-07, -1.7830762174381697e-09}, {0.026359596945567332, -0.004396741475935345, 0.00032170158437490874, -1.100010753692222e-05, 1.8675095798976004e-07, -1.2576652679897361e-09}, {-2.1015676761190153e-05, 0.00018744249901005703, 6.661693156420707e-06, -3.1348586167928655e-07, 8.067133977417068e-09, -7.969113860458257e-11}, {-2.1015676761190153e-05, 0.00018744249901005703, 6.661693156420707e-06, -3.1348586167928655e-07, 8.067133977417068e-09, -7.969113860458257e-11}, {0.541737992257342, -0.07612000940813557, 0.004293834871458331, -0.00012037490761198318, 1.6833170675708653e-06, -9.392769863975081e-09}, {0.19082912912108252, -0.026247572126268395, 0.0014661817862212127, -4.0427328157255185e-05, 5.56108985712876e-07, -3.0523223250138176e-09}, {0.036093800313952554, -0.006065334966177395, 0.0004336265597256202, -1.465177074202059e-05, 2.4418523082343644e-07, -1.6007231017577637e-09}, {0.036093800313952554, -0.006065334966177395, 0.0004336265597256202, -1.465177074202059e-05, 2.4418523082343644e-07, -1.6007231017577637e-09}, {1.1306222422124137, -0.14106091662195985, 0.007052835998556644, -0.00017571043435001026, 2.185614435788741e-06, -1.0858199052561635e-08}, {-4.545475470362371e-05, 0.00019619756941271122, 5.4795044925705635e-06, -2.3754213658547136e-07, 5.727679342107062e-09, -5.1868316163203906e-11}, {-4.545475470362371e-05, 0.00019619756941271122, 5.4795044925705635e-06, -2.3754213658547136e-07, 5.727679342107062e-09, -5.1868316163203906e-11}, {-4.810088500043592e-05, 0.00019796667868921355, 5.11574934589005e-06, -2.0727844139869348e-07, 4.686696267408675e-09, -4.025674786520961e-11}, {4.1336959370492545, -0.45978069374906083, 0.020454126235675784, -0.000454183444299844, 5.0370571754934515e-06, -2.232060425724769e-08}, {-0.3298236086286872, 0.029274879588952505, -0.0009573403977817563, 1.4038633134259501e-05, -7.710925513523207e-08}, {0.6637044135277504, -0.07252819545516992, 0.0031894618250742986, -6.983259486179526e-05, 7.643650183772539e-07, -3.346195368968824e-09}, {-0.008520787933647158, 0.001060345359757074, -2.918499028869645e-05, 4.821289902348147e-07, -2.931726792064428e-09}, {4.90962339092807, -0.5034724728604448, 0.020638869960572404, -0.0004221156655071418, 4.3098541473630026e-06, -1.7573880916471607e-08}, {4.294911744078657, -0.4414129988365033, 0.018135294095926843, -0.0003716679275495468, 3.8021000366712365e-06, -1.5531725447437417e-08}, {4.9739849224182215, -0.49427474400841764, 0.019642012819930468, -0.0003895648930946981, 3.858236703515759e-06, -1.526456804706866e-08}, {3.957934413303178, -0.39282325230719994, 0.015594054437376603, -0.00030888648115359903, 3.0550400980746176e-06, -1.2069210846010758e-08}, {2.5714773522718266, -0.2602577187155856, 0.010529907613654476, -0.00021225512372516508, 2.133838298237794e-06, -8.558372692826777e-09}, {0.842268160123487, -0.08551754463543104, 0.003480900375435944, -7.036759427610886e-05, 7.088164646271156e-07, -2.845843930301961e-09}, {0.3178941976820734, -0.032731286385973946, 0.0013612914632249386, -2.7931173316935552e-05, 2.85220160302127e-07, -1.1594187656390614e-09}, {0.005853279619014614, -0.0005640408680955425, 4.30278237309983e-05, -1.0897578019792519e-06, 1.3715728773156277e-08, -6.792633325253391e-11}, {38.31499085365601, -3.360941922427819, 0.11783928655334884, -0.002063782476793543, 1.805587366622086e-05, -6.31308814669218e-08}, {8.278916830386706, -0.7303265846015846, 0.025751258990397177, -0.0004531738044990375, 3.981875308108128e-06, -1.397502302769027e-08}, {12.681402391823225, -1.1139754249074545, 0.039102688103231587, -0.0006851118857290835, 5.993043140436029e-06, -2.0938511494095202e-08}, {0.32672055735999084, -0.03292544321835125, 0.0013387492017765449, -2.6819054317559746e-05, 2.669430233787057e-07, -1.05556479377579e-09}, {0.058083931555205, -0.00584572783182213, 0.00025267807928851694, -5.160616695689678e-06, 5.2234766109276795e-08, -2.0931984054048391e-10}, {63.954975042377136, -5.140539813994571, 0.16517833853471162, -0.00265187218309269, 2.127321464145092e-05, -6.821583378724405e-08}, {0.005414123142409508, -0.0005051598142629075, 3.972083971801381e-05, -9.925809293820593e-07, 1.2233972580150924e-08, -5.866046754246512e-11}, {0.21557484555878048, -0.021550691486233096, 0.0008740444004885428, -1.7345360650713508e-05, 1.705645179135687e-07, -6.64127555792364e-10}, {-0.14095444395366136, 0.009777067080887518, -0.00024045310921016658, 2.6984170127426177e-06, -1.1300656900157212e-08}, {0.4891096534035902, -0.04262851076079176, 0.0014966743106805064, -2.59807647281222e-05, 2.2446233487105065e-07, -7.718280983955161e-10}, {0.4891096534035902, -0.04262851076079176, 0.0014966743106805064, -2.59807647281222e-05, 2.2446233487105065e-07, -7.718280983955161e-10}, {36.924639564211326, -2.731053379993963, 0.08075735976401768, -0.0011930404315386818, 8.806330447809507e-06, -2.5983003498764035e-08}, {-2.0468575201779204, 0.11986743294822831, -0.0026190454238702384, 2.547582169595006e-05, -9.284824347343887e-08}, {7.911692454678671, -0.5864307001528991, 0.01738140487399068, -0.00025715889511000235, 1.9001445552734237e-06, -5.60953061778946e-09}, {-0.04035975905063838, 0.002896085578341906, -6.446518282496678e-05, 7.039405951871113e-07, -2.8504052635466674e-09}, {0.0003894077557760377, 0.0001285557190226884, 8.694130285994297e-06, -2.573048095222624e-07, 3.7929424983769686e-09, -2.067834448220556e-11}, {114.17940930874681, -7.844377610539263, 0.21546220414579012, -0.0029572740228186135, 2.0283187871316874e-05, -5.5615320987412176e-08}, {63.85476056135227, -4.373918723111312, 0.11978407687508656, -0.0016391152602742852, 1.1208079135755205e-05, -3.0637481399087285e-08}, {2.2011606623407514, -0.15929979266109676, 0.004617035140476651, -6.665696454553152e-05, 4.802401429316382e-07, -1.381218279507268e-09}, {0.14054975135533396, -0.013731761675546385, 0.0005489167427298999, -1.060245396112733e-05, 1.0081527451121327e-07, -3.7623199195847834e-10}, {0.13750272948908152, -0.011426384406550198, 0.0003936373932775353, -6.566621326917024e-06, 5.4365643306526666e-08, -1.78448848959286e-10}, {-2.0587964502388707, 0.11011667657724539, -0.0021952469693765084, 1.9474914228447358e-05, -6.468524803770678e-08}, {-3.737897620963333e-05, 0.00019651018063310982, 5.029686927109627e-06, -1.86043620686585e-07, 3.6195130969391974e-09, -2.341935185784115e-11}, {-4.690136377733661e-06, 0.0002016651059071739, 3.5139529776715452e-06, -8.350299037086096e-08, 1.0704336251927731e-09, -5.194413245346828e-12}, {-0.00010132294693875488, 0.0002175120037941468, 2.5505254420745407e-06, -5.6445957053122774e-08, 7.208367517024837e-10, -3.529536880812241e-12}, {14.032584445575685, -0.8945191628024881, 0.022793327354974136, -0.00028994192427466385, 1.8417961141434518e-06, -4.673927900961106e-09}, {277.2985787515956, -16.743998506048015, 0.40423808317204135, -0.004877200974766461, 2.940809994128558e-05, -7.089501413704014e-08}, {238.5917434593706, -14.216481903707884, 0.338753112150562, -0.004034711402401362, 2.402077374730671e-05, -5.7186652135943206e-08}, {-0.014270313901966362, 0.0012718561027298624, -2.6825640588712963e-05, 3.1709539327427124e-07, -1.3480069015473146e-09}, {-0.0031977982997584437, 0.0005120940286800045, -8.000797147914258e-06, 1.1825711726228343e-07, -5.879628779257207e-10}, {69.80528691888789, -4.185604044193048, 0.10031405748442707, -0.001200932337087573, 7.182105414832787e-06, -1.7164943383329856e-08}, {11.339880324743406, -0.7151239834910091, 0.018014981463589486, -0.00022633598572127244, 1.418670182027162e-06, -3.5485919445965575e-09}, {291.7087295708782, -16.428266225794683, 0.3699263859109312, -0.004163027530621755, 2.3414353778392245e-05, -5.2653144566594534e-08}, {0.538586899780204, -0.03906324176868443, 0.001139704473754362, -1.6377981293140965e-05, 1.1672268143859756e-07, -3.296963539851927e-10}, {-4.115988871662709, 0.19242977079441229, -0.0033590107469654933, 2.605550824765811e-05, -7.564975914491415e-08}, {0.7253279399633245, -0.04554447213839617, 0.0011519312011156514, -1.4413835165233314e-05, 8.980475515494262e-08, -2.228159265166979e-10}, {490.27393791481137, -26.377339622835038, 0.5674496055153969, -0.006101323676780913, 3.278883438602269e-05, -7.045674199623875e-08}, {215.07848395932143, -11.537210273695889, 0.2474638129040741, -0.0026528264399435534, 1.4213575839030438e-05, -3.0449805399346275e-08}};

double approx(double dt, unsigned int id) {

    std::vector<double> coeffs = Coeffs[id];

    double ref = noise[id];
    double fit = 0;

    for (size_t i = 0; i < coeffs.size(); i++) {

        fit += coeffs[i] * std::pow(dt, i);

    }

    return fit/ref;

}

double approx_linear(double dt, unsigned int id) {

    std::vector<double> coeffs = Coeffs[id];

    double Ddt = dt - dts[id];

    double ref = noise[id];
    double fit = 0;

    if (id < noise.size()) { fit = noise[id] + (noise[id]-noise[id+1])*Ddt/(dts[id]-dts[id+1]);}
    else {fit = noise[id] + (noise[id]-noise[id-1])*Ddt/(dts[id]-dts[id-1]);}

    return fit/ref;

}

}

#endif
